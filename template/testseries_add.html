{% extends 'admin.html' %}
{% load static %}
{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>        <h3>TestSerieAdd</h3>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="robots" content="noindex, nofollow">

    <title>registration - Bootsnipp.com</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="{% static 'admission/z8b1X_data/bootstrap_002.css' %}" rel="stylesheet" id="bootstrap-css">
    <style type="text/css">
    body {
     background: url('https://static-communitytable.parade.com/wp-content/uploads/2014/03/rethink-target-heart-rate-number-ftr.jpg') fixed;
    background-size: cover;
}

*[role="form"] {
    max-width: 530px;
    padding: 15px;
    margin: 0 auto;
    border-radius: 0.3em;
    background-color: #f2f2f2;
}

*[role="form"] h2 {
    font-family: 'Open Sans' , sans-serif;
    font-size: 40px;
    font-weight: 600;
    color: #000000;
    margin-top: 5%;
    text-align: center;
    text-transform: uppercase;
    letter-spacing: 4px;
}


    </style>
    <script src="{% static 'admission/z8b1X_data/jquery.js' %}"></script>
    <script src="{% static 'admission/z8b1X_data/bootstrap.js' %}"></script>
    <script type="{% static 'admission/text/javascript' %}">
        window.alert = function(){};
        var defaultCSS = document.getElementById('bootstrap-css');
        function changeCSS(css){
            if(css) $('head > link').filter(':first').replaceWith('<link rel="stylesheet" href="'+ css +'" type="text/css" />');
            else $('head > link').filter(':first').replaceWith(defaultCSS);
        }
        $( document ).ready(function() {
          var iframe_height = parseInt($('html').height());
          window.parent.postMessage( iframe_height, 'https://bootsnipp.com');
        });

    </script>
</head>

<body>
<link href="{% static 'admission/z8b1X_data/bootstrap.css' %}" rel="stylesheet" id="bootstrap-css">
<script src="{% static 'admission/z8b1X_data/bootstrap_002.js' %}"></script>
<script src="{% static 'admission/z8b1X_data/jquery-2.js' %}"></script>
<!------ Include the above in your HEAD tag ---------->

<div class="container">
        <form class="form-horizontal" role="form" method="POST">{% csrf_token %}




        <div class="form-group">
            <label class="control-label col-sm-3">Course</label>
            <div class="col-sm-9">
                <select name="course" id="course" class="col-sm-12" required>

                    <option value="">-- select course --</option>
                    {% for i in key1 %}
                    <option value="{{i.id}}">{{ i.coursename }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-sm-3">Batch</label>
            <div class="col-sm-9">


                   <select name="batch" id="batch" class="col-sm-12"  required>
                       <option value="">-- select batch --</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-sm-3">Subject</label>
            <div class="col-sm-9">


            <select name="subject" id="subject" class="col-sm-12" required>
                       <option value="">-- select subject --</option>
                   </select>

            </div>
        </div>

        <div class="form-group">
            <label for="birthDate" class="col-sm-3 control-label">Title</label>
            <div class="col-sm-9">
                <input type="text" id="birthDate" class="form-control" placeholder="enter title" name="title" required>
            </div>
        </div>

        <div class="form-group">
            <label for="birthDate" class="col-sm-3 control-label">Time(Minutes)</label>
            <div class="col-sm-9">
                <input type="text" id="birthDate" class="form-control" placeholder="enter time" name="time" required>
            </div>
        </div>

        <div class="form-group">
            <label for="birthDate" class="col-sm-3 control-label">TotalQuestions</label>
            <div class="col-sm-9">
                <input type="text" id="birthDate" class="form-control" placeholder="enter totalquestions" name="description" required>
            </div>
        </div>

        <div class="form-group">
            <label for="birthDate" class="col-sm-3 control-label">MarkForQuestions</label>
            <div class="col-sm-9">
                <input type="text" id="birthDate" class="form-control" placeholder="enter markforquestions" name="description" required>
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-sm-3">GradingSystem</label>
            <div class="col-sm-9">
                <select name="title" id="title" class="col-sm-12" required>

                    <option value="">-- select grading --</option>
                    {% for i in key2 %}
                    <option value="{{i.id}}">{{ i.Title }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>


        <div class="form-group">
            <label for="birthDate" class="col-sm-3 control-label">Description</label>
            <div class="col-sm-9">
                <input type="text" id="birthDate" class="form-control" placeholder="enter description" name="description" required>
            </div>
        </div>
<button name="add" id="add" onclick="myFunction()" class='btn btn-success' style="float:right"> + </button>
<form method="post">{% csrf_token %}


      <section class="content">
    <div class="row">
         <table id="myTable" class="table table-bordered table-hover" value="1">

                        <thead>
                        <th>sl.no</th>
                        <th>MaxMark</th>
                        <th>MinMark</th>

                        </tr>
                        </thead>
         </table>
  </div>
<!--        &lt;!&ndash; /.form-group &ndash;&gt;-->
        <button type="submit" name="submit" class="btn btn-primary btn-block">Submit</button>
            <input id="msg" value="{{key2}}" hidden>
      </section>
</form>
    <!-- /form --></div>
</div> <!-- ./container -->

 {% endblock %}
    {% block script %}
<script type="text/javascript">
	$(function(){
	$.validator.setDefaults({
		highlight: function(element){
			$(element)
			.closest('.form-group')
			.addClass('has-error')
		},
		unhighlight: function(element){
			$(element)
			.closest('.form-group')
			.removeClass('has-error')
		}
	});

	$.validate({
		rules:
		{
		    password: "required",
			birthDate: "required",
			weight: {
			    required:true,
			    number:true
			},
			height:  {
			    required:true,
			    number:true
			},
			email: {
				required: true,
				email: true
			}
		},
			messages:{
				email: {
				required: true,
				email: true
			}
		},
				password: {
					required: " Please enter password"
				},
				birthDate: {
					required: " Please enter birthdate"
				},
				email: {
					required: ' Please enter email',
					email: ' Please enter valid email'
				},
				weight: {
					required: " Please enter your weight",
					number: " Only numbers allowed"
				},
				height: {
					required: " Please enter your height",
					number: " Only numbers allowed"
				},
			}

	});
});
</script>
<script type="text/javascript">
function checkUser(data,usr){
                    console.log(data)
                    var batcharray =[]
                    var batcharrayid =[]
                  for (i=0; i<data.length; i++){
                    if( data[i].courseid.id == usr){
                    batcharrayid.push(data[i].id);
                    batcharray.push(data[i].batchname);
                    }
                  }

                    var string="<option>-- select batch --</option>"

                    for (i=0; i<batcharrayid.length; i++){
                    string=string+"<option value='"+batcharrayid[i]+"'>"+batcharray[i]+"</option>"
                    }
                    document.getElementById("batch").innerHTML = string;
                  }

function checkmyUser(data,usr){
                    var subjectarray =[]
                    var subjectarrayid =[]
                  for (i=0; i<data.length; i++){
                    if( data[i].courseid.id == usr){
                    subjectarrayid.push(data[i].id);
                    subjectarray.push(data[i].subject);
                    }
                  }


                    var string2="<option>-- select subject --</option>"
                    for (i=0; i<subjectarrayid.length; i++){
                    string2=string2+"<option value='"+subjectarrayid[i]+"'>"+subjectarray[i]+"</option>"
                    }
                    document.getElementById("subject").innerHTML = string2;
                  }
  $("#course").on("change",function(){


        var us = $("#course").val()
        var ourRequest = new XMLHttpRequest();
        var myRequest = new XMLHttpRequest();
        ourRequest.open('GET','/api/batchlist/')
        myRequest.open('GET','/api/subjectlist1/'+us+'/')
        ourRequest.onload = function(){
                        var ourData = JSON.parse(ourRequest.responseText);
                        checkUser(ourData,us);
                      };
        myRequest.onload = function(){
                        var myData = JSON.parse(myRequest.responseText);
                        checkmyUser(myData,us);
                      };
                      myRequest.send();
                      ourRequest.send();
         });


var j=1


  function myFunction() {
  var use =$("#courseid").val()
  console.log(use)
  var subRequest = new XMLHttpRequest();

subRequest.open('GET','/api/subjectlist1/'+use+'/')

        subRequest.onload = function(){
                        var subData = JSON.parse(subRequest.responseText);
                        checksubUser(subData,use);
                      };
                      subRequest.send();

  var table = document.getElementById("myTable");
  var rowCount=table.rows.length;
  var row = table.insertRow(rowCount);
  var cell1=row.insertCell(0)
  var element1=document.createElement("input");
  element1.type="number";
  element1.name="slno"+j;
  element1.id="slno"+j;
  cell1.appendChild(element1);
  var cell2=row.insertCell(1)
  var element2=document.createElement("input");
  element2.type="text";
  element2.name="maxmark"+j;
  element2.id="maxmark"+j;
      cell2.appendChild(element2)
      var cell3=row.insertCell(2)
      var element3 = document.createElement('input');
      element3.type = 'text';
      element3.name = 'minmark'+j;
      element3.id ='minmark'+j;
  cell3.appendChild(element3);


 }










       </script>
    {% endblock %}
